# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É: Lootbox iFrame Widget

**Lootbox iFrame Widget** - –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–π Vue 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –≤ iframe, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –∫–∞—Å—Ç–æ–º—ñ–∑—É–≤–∞—Ç–∏ —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –ª—É—Ç–±–æ–∫—Å –ø—ñ–¥ —Ä—ñ–∑–Ω—ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ —Å–µ–≥–º–µ–Ω—Ç–∏ –≥—Ä–∞–≤—Ü—ñ–≤.

- **–ù–µ–∑–∞–ª–µ–∂–Ω–∏–π iframe –ª—É—Ç–±–æ–∫—Å** - —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- **–î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è** —á–µ—Ä–µ–∑ PostMessage API
- **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏** - –¥–∏–Ω–∞–º—ñ—á–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- **Vue 3 + Composition API + TypeScript** - —Å—É—á–∞—Å–Ω–∏–π —Å—Ç–µ–∫
- **–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è** –±–µ–∑ GSAP (requestAnimationFrame)
- **–ú–æ–¥—É–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–º** - –ª–µ–≥–∫–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –¥–∏–∑–∞–π–Ω—ñ–≤

## üìã –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π

```
Projects/lootbox-iframe-widget-vue/
‚îú‚îÄ‚îÄ public/                  # –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ (–∫–æ–ø—ñ—é—é—Ç—å—Å—è –≤ dist)
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îî‚îÄ‚îÄ bootstrap.js     # –†–∞–Ω–Ω—ñ–π —Ä–∞–Ω—Ç–∞–π–º
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ composables/          # –ü–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWheelAnimation.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usePostMessageBus.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª—ñ—Ç–∏ (–ø–∞—Ä—Å–∏–Ω–≥ —Å–µ–∫—Ç–æ—Ä—ñ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ themes/              # –¢–µ–º–∏ –¥–∏–∑–∞–π–Ω—É
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ default/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ theme.scss
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ _animations.scss
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ _tokens.scss
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ crown/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ theme.scss
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ _animations.scss
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ _tokens.scss
‚îÇ   ‚îî‚îÄ‚îÄ App.vue              # –ì–æ–ª–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îú‚îÄ‚îÄ vite/                    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–±—ñ—Ä–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ plugins/
‚îÇ       ‚îî‚îÄ‚îÄ vite-plugin-themes.ts
‚îú‚îÄ‚îÄ dist/                    # –ó—ñ–±—Ä–∞–Ω—ñ —Ñ–∞–π–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bootstrap.js     # –ö–æ–ø—ñ—è –∑ public/js/
‚îÇ   ‚îî‚îÄ‚îÄ themes/              # –ì–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–µ–º (–∑ src/themes/)
‚îÇ       ‚îú‚îÄ‚îÄ themes-config.js # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –≤—Å—ñ—Ö —Ç–µ–º
‚îÇ       ‚îú‚îÄ‚îÄ default/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ theme.css    # –ö–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π CSS (–∑ src/themes/default/theme.scss)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ images/      # –ö–æ–ø—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω—å (–∑ src/themes/default/images/)
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ bg.webp, logo.svg, preloader.svg, wheelpointer.webp, ...
‚îÇ       ‚îî‚îÄ‚îÄ crown/
‚îÇ           ‚îú‚îÄ‚îÄ theme.css    # –ö–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π CSS (–∑ src/themes/crown/theme.scss)
‚îÇ           ‚îî‚îÄ‚îÄ images/      # –ö–æ–ø—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω—å (–∑ src/themes/crown/images/)
‚îÇ               ‚îú‚îÄ‚îÄ bg.webp, logo.svg, preloader.svg, wheelpointer.webp, ...
‚îî‚îÄ‚îÄ test-lootbox.html        # –¢–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø
```

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

**–ü–æ—Ç–æ—á–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:**

- –î–∏–Ω–∞–º—ñ—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π
- –ú–æ–¥—É–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –õ–µ–≥–∫–∞ –∫–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏

### –°–∏—Å—Ç–µ–º–∞ –∑–±—ñ—Ä–∫–∏ —Ç–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Ä–µ—Å—É—Ä—Å—ñ–≤

**Vite Plugin System** (`vite-plugin-themes.ts`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

- –ì–µ–Ω–µ—Ä—É—î `themes-config.js` –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é –≤—Å—ñ—Ö —Ç–µ–º
- –ö–æ–º–ø—ñ–ª—é—î SCSS —Ñ–∞–π–ª–∏ –≤ CSS –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ç–µ–º–∏
- –ö–æ–ø—ñ—é—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ `dist/themes/`
- –°—Ç–≤–æ—Ä—é—î –≥–æ—Ç–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É

**Bootstrap.js** (`public/js/bootstrap.js`):

- **–†–∞–Ω–Ω—ñ–π —Ä–∞–Ω—Ç–∞–π–º** - –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –î–û main.ts
- **–ü–∞—Ä—Å–∏–Ω–≥ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤** –¥–ª—è –≤–∏–±–æ—Ä—É —Ç–µ–º–∏
- **–î–∏–Ω–∞–º—ñ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** CSS —Å—Ç–∏–ª—ñ–≤ —Ç–µ–º–∏
- **–ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –≤—Å—ñ—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–µ–º–∏
- **–ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è FOUC** (Flash of Unstyled Content)
- **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞** –¥–ª—è Vue –¥–æ–¥–∞—Ç–∫—É
- **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è** `window.currentTheme` –∑ –≥–æ—Ç–æ–≤–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏

## üìã –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º

### –†–æ–∑–º—ñ—â–µ–Ω–Ω—è —Ç–µ–º —É src/, –∞ –Ω–µ –≤ public/

–£—Å—ñ –∫–æ–Ω—Ñ—ñ–≥–∏, —Å—Ç–∏–ª—ñ —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–µ–º –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ `src/themes`. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î:

- **–¢–∏–ø–æ–±–µ–∑–ø–µ–∫—É**: `config.ts` –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É TypeScript
- **–Ñ–¥–∏–Ω–∏–π –∑–±—ñ—Ä–æ—á–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω**: SCSS –∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑—É—é—Ç—å—Å—è, —Ä–µ—Å—É—Ä—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–ø—ñ—é—é—Ç—å—Å—è —É `dist/`
- **–ö–µ—Ä–æ–≤–∞–Ω—ñ—Å—Ç—å —Ç–∞ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è**: —Ç–µ–º–∏ –≤–µ—Ä—Å—ñ–æ–Ω—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º —ñ–∑ –∫–æ–¥–æ–º, –∑–º—ñ–Ω–∏ –ª–µ–≥–∫–æ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É—é—Ç—å—Å—è —Ç–∞ –≤—ñ–¥–∫–æ—á—É—é—Ç—å—Å—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é**: —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π Vite-–ø–ª–∞–≥—ñ–Ω –≥–µ–Ω–µ—Ä—É—î `themes-config.js` –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤—Ç—Ä—É—á–∞–Ω–Ω—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–º–∏

```
src/themes/
‚îú‚îÄ‚îÄ default/
‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îú‚îÄ‚îÄ theme.scss
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ       ‚îú‚îÄ‚îÄ _animations.scss
‚îÇ       ‚îî‚îÄ‚îÄ _tokens.scss
‚îú‚îÄ‚îÄ crown/
‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îú‚îÄ‚îÄ theme.scss
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ       ‚îú‚îÄ‚îÄ _animations.scss
‚îÇ       ‚îî‚îÄ‚îÄ _tokens.scss
```

### –î–∏–Ω–∞–º—ñ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

- **Query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏**:
  - `?style=1` - –≤–∏–±—ñ—Ä —Ç–µ–º–∏ –∑–∞ ID (default, crown, —Ç–æ—â–æ)
  - `?sectors=100%20FS,50%20USD` - –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ç–æ—Ä—ñ–≤
  - `?sectors_type=Free%20Spins,USD` - —Ç–∏–ø–∏ –ø—Ä–∏–∑—ñ–≤ –¥–ª—è —Å–µ–∫—Ç–æ—Ä—ñ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—è** SCSS –≤ CSS
- **–ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–µ–º–∏
- **–ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è FOUC** (Flash of Unstyled Content)

### –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:**

1. **index.html** –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è
2. **bootstrap.js** (`public/js/bootstrap.js`) –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –î–û main.ts
3. **main.ts** —á–µ–∫–∞—î –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ —Ç–µ–º–∏ (`window.currentTheme.ready`)
4. **Vue –¥–æ–¥–∞—Ç–æ–∫** —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤

### –°–∏—Å—Ç–µ–º–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤

**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –¥–≤–æ–µ—Ç–∞–ø–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è FOUC (Flash of Unstyled Content) —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –º–∏—Ç—Ç—î–≤–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–µ–º–∏.

**–ï—Ç–∞–ø 1: Bootstrap (bootstrap.js)**

- –ü–∞—Ä—Å–∏–Ω–≥ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ –≤–∏–±—ñ—Ä —Ç–µ–º–∏
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSS —Å—Ç–∏–ª—ñ–≤ —Ç–µ–º–∏
- –ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–µ–º–∏
- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è `window.currentTheme` –∑ –≥–æ—Ç–æ–≤–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏

**–ï—Ç–∞–ø 2: Vue —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è (main.ts)**

- –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ —Ç–µ–º–∏ (`window.currentTheme.ready`)
- –ó–∞–ø—É—Å–∫ Vue –¥–æ–¥–∞—Ç–∫—É —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤
- Fallback –º–µ—Ö–∞–Ω—ñ–∑–º –∑ —Ç–∞–π–º–∞—É—Ç–æ–º (6 —Å–µ–∫)

```javascript
// bootstrap.js - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–µ–º–∏
const cssReady = loadThemeStylesheet(selectedTheme)
await waitForAllImages(selectedTheme.images, IMAGE_LOAD_TIMEOUT_MS)
await cssReady

// main.ts - —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—é —Ç–µ–º–∏
async function waitThemeReady(): Promise<void> {
  while (!window.currentTheme?.ready) {
    await new Promise(resolve => setTimeout(resolve, POLLING_INTERVAL_MS))
  }
}
await waitThemeReady() // Vue —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

- –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è FOUC (Flash of Unstyled Content)
- –ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSS —Å—Ç–∏–ª—ñ–≤ —Ç–µ–º–∏
- –ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–µ–º–∏ –≤ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ `fetchPriority: 'high'`
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI
- –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å —Ç–µ–º–∏ –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º
- –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é Vue

### –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–µ–º–∏

```typescript
// src/themes/default/config.ts
export const defaultTheme = {
  id: 1,
  name: 'Default Theme',
  sectors: ['100 FS', '50 USD', '200 EUR'],
  sectorsType: ['Free Spins', 'USD', 'EUR'],
  images: {
    wheel: '/themes/default/images/wheel.png',
    background: '/themes/default/images/background.png',
  },
  styles: {
    primary: '#007bff',
    secondary: '#6c757d',
    accent: '#28a745',
  },
}
```

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —Ç–µ–º–∏

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É `src/themes/your-theme/`
2. –î–æ–¥–∞–π—Ç–µ `config.ts` –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é
3. –°—Ç–≤–æ—Ä—ñ—Ç—å `theme.scss` –∑—ñ —Å—Ç–∏–ª—è–º–∏
4. –î–æ–¥–∞–π—Ç–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ –ø–∞–ø–∫—É `images/`
5. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –∞–Ω—ñ–º–∞—Ü—ñ—ó –≤ `styles/_animations.scss`
6. –í–∏–∑–Ω–∞—á—Ç–µ —Ç–æ–∫–µ–Ω–∏ –≤ `styles/_tokens.scss`

### SCSS —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```scss
// theme.scss
@import './styles/tokens';
@import './styles/animations';

.lootbox-theme {
  // –û—Å–Ω–æ–≤–Ω—ñ —Å—Ç–∏–ª—ñ —Ç–µ–º–∏
}
```

```scss
// _tokens.scss
:root {
  --primary-color: #007bff;
  --secondary-color: #6c757d;
  --border-radius: 4px;
}
```

```scss
// _animations.scss
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
```

## üìã –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ URL

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏

–ü—Ä–æ–µ–∫—Ç –ø—ñ–¥—Ç—Ä–∏–º—É—î 4 –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

- **`style`** - ID —Ç–µ–º–∏ (—á–∏—Å–ª–æ)
- **`sectors`** - —Å–ø–∏—Å–æ–∫ —Å–µ–∫—Ç–æ—Ä—ñ–≤ –∑ –ø—Ä–∏–∑–∞–º–∏
- **`sectors_type`** - —Ç–∏–ø–∏ –ø—Ä–∏–∑—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞
- **`active`** - –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ª—É—Ç–±–æ–∫—Å–∞ (boolean, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º true)

### –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```
?style=2&sectors=100%20FS,50%20USD&sectors_type=Free%20Spins,USD
?style=1&sectors=500%20USD&sectors_type=Bonus%20Prize&active=false
```

## üìã –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

### Vue 3 + Composition API

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

- –ö—Ä–∞—â–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- Tree-shaking
- TypeScript –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
- –ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ –≤–∏–Ω–µ—Å–µ–Ω–Ω—è–º –≤–∞–∂–∫–æ—ó –ª–æ–≥—ñ–∫–∏ –≤ composables

## üìã –°–∏—Å—Ç–µ–º–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó

### –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

**requestAnimationFrame –∑–∞–º—ñ—Å—Ç—å GSAP:**

```typescript
const handleAnimationFrame = (start: number, startAngle: number) => {
  const now = performance.now()
  const t = Math.min(1, (now - start) / duration)
  // –ü–ª–∞–≤–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –∑ easing
}
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

- –ú–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä –±–∞–Ω–¥–ª–∞ (–±–µ–∑ GSAP)
- –ö—Ä–∞—â–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
- –ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∞–Ω—ñ–º–∞—Ü—ñ—î—é
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å

### –î–≤–æ—Ñ–∞–∑–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏

1. **–§–∞–∑–∞ 1**: –ó–≤–∏—á–∞–π–Ω–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è (3s, linear) - –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –ø–æ –∫–æ–º–∞–Ω–¥—ñ –∑ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ —Å–∞–π—Ç—É
2. **–§–∞–∑–∞ 2**: Spin to win (14s, ease-out) - –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ winnerSection –∑ –±–µ–∫–µ–Ω–¥–∞

**–î–∏–Ω–∞–º—ñ—á–Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è**: –ê–Ω—ñ–º–∞—Ü—ñ—è –º–æ–∂–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–∏—Å—è –º—ñ–∂ —Ñ–∞–∑–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É.

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—ó

```typescript
const SPIN_WITHOUT_WIN_DURATION = 3000 // 3 —Å–µ–∫—É–Ω–¥–∏
const SPIN_WITH_WIN_DURATION = 14000 // 14 —Å–µ–∫—É–Ω–¥
const SWITCH_EFFECTS_THRESHOLD = 0.7 // 70% –ø—Ä–æ–≥—Ä–µ—Å—É
```

### Easing —Ñ—É–Ω–∫—Ü—ñ—ó

```typescript
// –õ—ñ–Ω—ñ–π–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
t = t

// Ease-out –¥–ª—è –≤–∏–≥—Ä–∞—à–Ω–æ—ó –∞–Ω—ñ–º–∞—Ü—ñ—ó
t = 1 - Math.pow(1 - t, 4)
```

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

- **requestAnimationFrame** –¥–ª—è –ø–ª–∞–≤–Ω–æ—ó –∞–Ω—ñ–º–∞—Ü—ñ—ó
- **–î–∏–Ω–∞–º—ñ—á–Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è** –µ—Ñ–µ–∫—Ç—ñ–≤
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è** –∑–æ–±—Ä–∞–∂–µ–Ω—å
- **–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ easing** —Ñ—É–Ω–∫—Ü—ñ—ó

## üìã PostMessage API

### –í—Ö—ñ–¥–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

```typescript
// –í—ñ–¥ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ —Å–∞–π—Ç—É
{
  type: 'startSpin'
}
{
  type: 'winSector',
  data: 5 // –Ω–æ–º–µ—Ä —Å–µ–∫—Ç–æ—Ä–∞ (0-7)
}
```

### –í–∏—Ö—ñ–¥–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

```typescript
// –î–æ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ —Å–∞–π—Ç—É
{
  type: 'lootboxReady'
}
{
  type: 'winSector',
  data: { sector: 5, timestamp: 1234567890 }
}
{
  type: 'spinEnd',
  data: { prize: '1000 USD', timestamp: 1234567890 }
}
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤

#### 1. –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è iframe

```html
<iframe src="https://lootbox.example.com/?sectors=100%20FS&style=default" id="lootbox-iframe">
</iframe>
```

#### 2. –ó–∞–ø—É—Å–∫ –∞–Ω—ñ–º–∞—Ü—ñ—ó

```javascript
const iframe = document.getElementById('lootbox-iframe')
iframe.contentWindow.postMessage({ type: 'startSpin' }, '*')
```

#### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏–≥—Ä–∞—à–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞

```javascript
// –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å–µ–∫—Ç–æ—Ä –ø—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –∞–Ω—ñ–º–∞—Ü—ñ—ó
iframe.contentWindow.postMessage(
  {
    type: 'winSector',
    data: 5, // –Ω–æ–º–µ—Ä —Å–µ–∫—Ç–æ—Ä–∞ (0-7)
  },
  '*'
)
```

#### 4. –û–±—Ä–æ–±–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

```javascript
window.addEventListener('message', event => {
  if (event.data.type === 'spinEnd') {
    console.log('–ü—Ä–∏–∑:', event.data.data.prize)
  }
})
```

### –¢–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

**lootboxReady** - –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∫–æ–ª–∏ –ª—É—Ç–±–æ–∫—Å –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏.

**startSpin** - –∑–∞–ø—É—Å–∫–∞—î –∞–Ω—ñ–º–∞—Ü—ñ—é –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –∫–æ–ª–µ—Å–∞.

**winSector** - –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –≤–∏–≥—Ä–∞—à–Ω–∏–π —Å–µ–∫—Ç–æ—Ä (–≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ —Å–∞–π—Ç—É).

**spinEnd** - –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º.

## üìã –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ü—Ä–æ—Ç–æ—Ç–∏–ø —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

`test-lootbox.html` –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î:

- –ó–∞–ø—É—Å–∫ –∞–Ω—ñ–º–∞—Ü—ñ—ó –∑ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ —Å–∞–π—Ç—É
- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏–≥—Ä–∞—à–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ dropdown
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –î–∏–Ω–∞–º—ñ—á–Ω—É –∑–º—ñ–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é –ª—É—Ç–±–æ–∫—Å–∞
- –õ–æ–≥—É–≤–∞–Ω–Ω—è –∑ –ø—Ä–µ—Ñ—ñ–∫—Å–∞–º–∏ [WIDGET]/[PARENT]

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

#### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä

```bash
npm run dev
```

#### 2. –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª

```
http://localhost:5173/test-lootbox.html
```

## üìã –ó–±—ñ—Ä–∫–∞ —Ç–∞ –¥–µ–ø–ª–æ–π

### Development

```bash
npm run dev
```

### Production

```bash
npm run build
```

- `dist/` –º—ñ—Å—Ç–∏—Ç—å –≥–æ—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏
- `themes-config.js` –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è–º–∏ –≤—Å—ñ—Ö —Ç–µ–º
- –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —Å—Ç–∏–ª—ñ

### –†–æ–∑–º—ñ—â–µ–Ω–Ω—è –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–º—É —Ö–æ—Å—Ç–∏–Ω–≥—É

–ü—Ä–æ–µ–∫—Ç –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è —Ä–æ–±–æ—Ç–∏ —è–∫ –≤ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É, —Ç–∞–∫ —ñ –≤ –ø—ñ–¥–ø–∞–ø–∫–∞—Ö:

- **–ö–æ—Ä—ñ–Ω—å —Å–∞–π—Ç—É**: `https://example.com/` - –ø—Ä–∞—Ü—é—î –±–µ–∑ –∑–º—ñ–Ω
- **–ü—ñ–¥–ø–∞–ø–∫–∞**: `https://example.com/subfolder/` - –ø—Ä–∞—Ü—é—î –±–µ–∑ –∑–º—ñ–Ω

–í—Å—ñ —Ä–µ—Å—É—Ä—Å–∏ (CSS, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —Å–∫—Ä–∏–ø—Ç–∏) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≤—ñ–¥–Ω–æ—Å–Ω—ñ —à–ª—è—Ö–∏ –∑–∞–≤–¥—è–∫–∏:
- `base: './'` —É `vite.config.ts`
- –í—ñ–¥–Ω–æ—Å–Ω—ñ —à–ª—è—Ö–∏ —É `bootstrap.js` —Ç–∞ –≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è—Ö
- –í—ñ–¥–Ω–æ—Å–Ω—ñ —à–ª—è—Ö–∏ —É `index.html`

–ü—Ä–æ—Å—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –≤–º—ñ—Å—Ç –ø–∞–ø–∫–∏ `dist/` –Ω–∞ –≤–∞—à —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Ö–æ—Å—Ç–∏–Ω–≥ –≤ –±—É–¥—å-—è–∫—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é.
