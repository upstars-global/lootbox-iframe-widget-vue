Загальний опис

Цей документ містить всю необхідну інформацію для інтеграції віджета лутбокса через iframe. Лутбокс комунікує з батьківським сайтом через PostMessage API, а тексти та стан встановлюються через query параметри.

**Підтримка мультипроектності:** Віджет підтримує роботу з різними проектами (Rocket, King тощо). Кожен проект має свою дефолтну тему.

Приклади посилань на iframe:

Для проекту Rocket:
https://rocketplay-bonuses.club/lootbox/index.html?project=rocket

Для проекту King:
http://cdn-wl.s3.amazonaws.com/common/lootbox/king/index.html?project=king

Наглядний тест взаємодії з батьківським сайтом:
https://rocketplay-bonuses.club/lootbox/test-lootbox.html

Повідомлення від лутбокса (вихідні фронту)

1. 'lootboxReady'

Коли надсилається: Відразу після повного завантаження віджета та готовності до роботи.

Формат:
javascript
{
type: 'lootboxReady'
}

Що потрібно зробити:

- (Опціонально) зберегти стан готовності віджета
- Розблокувати UI (кнопку "Спін")
- Можна починати відправляти команди до лутбокса

---

2.  'spinEnd'

Коли надсилається: Після завершення анімації обертання та відображення анімації виграшу (~6 секунд після завершення обертання колеса, коли ще відображається анімація виграшу).

Формат:
javascript
{
type: 'spinEnd',
data: {
prize: '500 USD', // Текст призу з виграшного сектора (опціонально додали, можна брати з беку)
}
}

Що потрібно зробити:

- Обробити результат
- Показати попап користувачу про виграш
- Можливо залогувати результат (аналітика, бекенд)
- Можливо скинути стан для наступної гри

Повідомлення до лутбокса (з фронта)

1.  'startSpin'

Коли відправляти: Коли користувач ініціює обертання (натискає кнопку Spin).

Формат:
javascript
{
type: 'startSpin'
}

Що відбувається:

- Колесо починає обертатися зі сталою швидкістю
- Анімація триває 3 секунди у режимі очікування циклічно
- Якщо протягом цього часу не отримано 'winSector', колесо продовжує обертатися

Важливо:

- Відправляйте тільки після отримання 'lootboxReady'
- Після відправки відразу робіть запит на бекенд для отримання виграшного сектора

---

2.  'winSector'

Коли відправляти: Після отримання виграшного сектора з бекенда.

Формат:
javascript
{
type: 'winSector',
data: 5 // Номер виграшного сектора (Number)
}

Query-параметри для URL iframe

'project' ⭐ NEW

- Тип: String
- Опис: Назва проекту для визначення дефолтної теми
- Доступні значення:
  - 'rocket' - проект Rocket (дефолтна тема: RocketWheelLite)
  - 'king' - проект King (дефолтна тема: KingWheel)
- Приклад: '?project=king'
- ⚠️ Важливо: Якщо вказано `project`, але тема (`style`) не належить цьому проекту — буде використано дефолтну тему проекту

'style'

- Тип: String
- Опис: Назва теми візуального оформлення
- Доступні на даний момент значення:
  - 'RocketWheelLite' - тема для Rocket Wheel Lite (дефолт для проекту Rocket)
  - 'RocketWheelPro' - тема для Rocket Wheel Pro
  - 'KingWheel' - тема для King (дефолт для проекту King)
- Приклад: '?style=RocketWheelPro' або '?project=rocket&style=RocketWheelPro'

Логіка вибору теми:

1. Якщо передано `?style=` без `?project=` — використовується вказана тема (зворотна сумісність)
2. Якщо передано `?project=` без `?style=` — використовується дефолтна тема проекту
3. Якщо передано обидва — валідується належність теми до проекту

'sectors'

- Тип: String (розділені крапкою з комою)
- Опис: Список призів для секторів колеса
- Формат: Текстові значення через крапку з комою (;): '"500 USD; 5,000 USD; 10 FS; ..."'
- Кількість: Рекомендовано 8 секторів (повинна відповідати кількості 'sectors_type')
- URL encoding: Пробіли та спецсимволи повинні бути закодовані ('%20' для пробілів, '%3B' для крапки з комою)
- Декодований приклад: '500 USD; 5,000 USD; 10 FS; 20 FS; 35 FS; 25 USD; 100 USD; 250 USD'
- ⚠️ Важливо: Використовуйте крапку з комою (;) як розділювач, щоб підтримувати коми в сумах (наприклад, "5,000 USD")

'sectors_type'

- Тип: String (розділені крапкою з комою)
- Опис: Типи призів для кожного сектора
- Формат: Текстові значення через крапку з комою (;)
- Кількість: Має відповідати кількості 'sectors'
- Типові значення:
  - 'Bonus Prize' - бонусні призи
  - 'Free Spins' - безкоштовні спіни
  - 'Cash Prize' - готівкові призи
  - Або будь-які кастомні назви
- Декодований приклад: 'Bonus Prize; Bonus Prize; Free Spins; Free Spins; Free Spins; Bonus Prize; Bonus Prize; Bonus Prize'

'active'

- Тип: Boolean
- За замовчуванням: 'true'
- Опис: Визначає чи активний лутбокс
- Використання: Встановіть 'false' якщо користувач зараз не може прокрутити колесо
- Приклад: '?active=false'

'vip_level'

- Тип: Number (integer >= 0)
- За замовчуванням: '0'
- Опис: VIP рівень гравця
- Приклад: '?vip_level=5'
- ⚠️ Важливо: Параметр зарезервований для майбутнього. Наразі не впливає на відображення колеса, але в майбутніх версіях може використовуватись для кастомізації дизайну під рівні гравця.

'fps' (опціональний параметр)

- Тип: Boolean
- За замовчуванням: 'false'
- Опис: Показує FPS-монітор для діагностики продуктивності
- Використання: Для debug режиму
- Приклад: '?fps=true'
